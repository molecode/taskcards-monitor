services:
  taskcards-monitor:
    image: ghcr.io/molecode/taskcards-monitor:latest
    # Or use a specific version:
    # image: ghcr.io/molecode/taskcards-monitor:0.2.0

    # Mount the cache directory to persist board state between runs
    volumes:
      - taskcards-data:/home/taskcards/.cache/taskcards-monitor
      # Uncomment to enable email notifications (see README for setup):
      # - ./email-config.yaml:/home/taskcards/email-config.yaml:ro

    # Example: Check a board for changes
    # Override this command based on your needs
    command: ["check", "YOUR_BOARD_ID"]

    # For private boards, you can pass the view token via environment variable
    # and reference it in the command
    environment:
      - TASKCARDS_TOKEN=${TASKCARDS_TOKEN:-}

    # Examples:
    # Private board with token:
    # command: ["check", "YOUR_BOARD_ID", "--token", "${TASKCARDS_TOKEN}"]
    #
    # With email notifications (requires email-config.yaml, see README):
    # command: ["check", "YOUR_BOARD_ID", "--email-config", "/home/taskcards/email-config.yaml"]

volumes:
  taskcards-data:
    driver: local

# Example usage:
#
# 1. Check a public board:
#    docker compose run --rm taskcards-monitor check YOUR_BOARD_ID
#
# 2. Check a private board with token:
#    TASKCARDS_TOKEN=your-token docker compose run --rm taskcards-monitor check YOUR_BOARD_ID --token "$TASKCARDS_TOKEN"
#
# 3. With email notifications (create email-config.yaml first, see README):
#    docker compose run --rm taskcards-monitor check YOUR_BOARD_ID --email-config /home/taskcards/email-config.yaml
#
# 4. Show saved state:
#    docker compose run --rm taskcards-monitor show YOUR_BOARD_ID
#
# 5. List all monitored boards:
#    docker compose run --rm taskcards-monitor list
#
# 6. Run as a cron job (add to crontab):
#    0 */3 * * * cd /path/to/repo && docker compose run --rm taskcards-monitor check YOUR_BOARD_ID
